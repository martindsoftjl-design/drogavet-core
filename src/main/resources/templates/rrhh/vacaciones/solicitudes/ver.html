<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/layout-rrhh :: layout(
            ~{::title},
            ~{::content},
            ~{},
            ~{}
      )}">

<head>
    <title>Detalle de Solicitud</title>
</head>

<body>
<div th:fragment="content">

    <div class="container mt-4">

        <div class="row justify-content-center">
            <div class="col-md-8">

                <div class="card shadow-sm">

                    <!-- HEADER -->
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">Solicitud de Vacaciones</h5>

                        <span class="badge fs-6"
                              th:text="${detalle.estado}"
                              th:classappend="
                                ${detalle.estado.name() == 'PENDIENTE'} ? 'bg-warning text-dark' :
                                ${detalle.estado.name() == 'APROBADO'} ? 'bg-success' :
                                'bg-danger'">
                        </span>
                    </div>

                    <!-- BODY -->
                    <div class="card-body">

                        <div class="mb-3">
                            <strong>Empleado:</strong>
                            <span th:text="${detalle.periodo.empleado.nombres + ' ' +
                                            detalle.periodo.empleado.apellidos}">
                            </span>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Fecha inicio:</strong>
                                <div th:text="${#temporals.format(detalle.fechaInicio,'dd/MM/yyyy')}"></div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <strong>Fecha fin:</strong>
                                <div th:text="${#temporals.format(detalle.fechaFin,'dd/MM/yyyy')}"></div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Días solicitados:</strong>
                                <div th:text="${detalle.diasTomados}"></div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <strong>Tipo:</strong>
                                <div th:text="${detalle.tipo}"></div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <strong>Observación:</strong>
                            <div class="border rounded p-2 bg-light"
                                 th:text="${detalle.observacion ?: '—'}">
                            </div>
                        </div>

                        <!-- ACCIONES RRHH -->
                        <div class="d-flex justify-content-end gap-2"
                             th:if="${detalle.estado == T(com.laboratoriosdrogavet.core.rrhh.enums.EstadoVacaciones).PENDIENTE}">

                            <!-- RECHAZAR -->
                            <form th:action="@{/rrhh/vacaciones/solicitudes/{id}/rechazar(id=${detalle.id})}"
                                  method="post">

                                <input type="hidden"
                                       th:name="${_csrf.parameterName}"
                                       th:value="${_csrf.token}" />

                                <input type="hidden"
                                       name="motivo"
                                       value="Rechazado por RRHH"/>

                                <button type="submit"
                                        class="btn btn-outline-danger">
                                    Rechazar
                                </button>
                            </form>

                            <!-- APROBAR -->
                            <form th:action="@{/rrhh/vacaciones/solicitudes/{id}/aprobar(id=${detalle.id})}"
                                  method="post">

                                <input type="hidden"
                                       th:name="${_csrf.parameterName}"
                                       th:value="${_csrf.token}" />

                                <button type="submit"
                                        class="btn btn-success">
                                    Aprobar
                                </button>
                            </form>

                        </div>

                        <!-- VOLVER -->
                        <div class="mt-4">
                            <a th:href="@{/rrhh/vacaciones/solicitudes/lista}"
                               class="btn btn-secondary">
                                Volver al listado
                            </a>
                        </div>

                    </div>

                </div>

            </div>
        </div>

    </div>

</div>
</body>
</html>

<!DOCTYPE html>
<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/layout-rrhh :: layout(
            ~{::title},
            ~{::content},
            ~{},
            ~{}
      )}">

<head>
    <title>Solicitudes del Periodo</title>
</head>

<body>
<div th:fragment="content" class="container py-4">

    <div class="container mt-4">

        <!-- HEADER -->
        <div class="mb-4">
            <h4 class="fw-bold mb-0">
                Solicitudes del Periodo
            </h4>
            <small class="text-muted">
                <span th:text="${periodo.empleado.nombres + ' ' + periodo.empleado.apellidos}"></span>
                · Periodo
                <span th:text="${#temporals.format(periodo.fechaInicio,'dd/MM/yyyy')}"></span>
					    →
			   <span th:text="${#temporals.format(periodo.fechaFin,'dd/MM/yyyy')}"></span>
            </small>
        </div>

        <!-- RESUMEN -->
        <div class="alert alert-info d-flex justify-content-between align-items-center">
            <div>
                <strong>Saldo disponible:</strong>
                <span th:text="${periodo.saldo}"></span> días
            </div>

            <span class="badge fs-6"
                  th:text="${periodo.estado}"
                  th:classappend="
                      ${periodo.estado == T(com.laboratoriosdrogavet.core.rrhh.enums.EstadoPeriodo).ACTIVO}
                      ? ' bg-success'
                      : ' bg-secondary'">
            </span>
        </div>

        <!-- TABLA SOLICITUDES -->
        <div class="card shadow-sm">
            <div class="card-body p-0">

                <table class="table table-hover mb-0">
                    <thead class="table-light">
                    <tr>
                        <th>Fechas</th>
                        <th>Días</th>
                        <th>Tipo</th>
                        <th>Estado</th>
                        <th class="text-end">Acción</th>
                    </tr>
                    </thead>

                    <tbody>

                    <tr th:each="s : ${solicitudes}">
                        <td
                            th:text="${#temporals.format(s.fechaInicio,'dd/MM/yyyy')
                                      + ' → ' +
                                      #temporals.format(s.fechaFin,'dd/MM/yyyy')}">
                        </td>

                        <td th:text="${s.diasTomados}"></td>

                        <td th:text="${s.tipoVacacion.descripcion}"></td>

                        <td>
                            <span class="badge"
                                  th:text="${s.estado}"
                                  th:classappend="
                                      ${s.estado == T(com.laboratoriosdrogavet.core.rrhh.enums.EstadoSolicitud).APROBADA}
                                      ? ' bg-success'
                                      : ${s.estado == T(com.laboratoriosdrogavet.core.rrhh.enums.EstadoSolicitud).PENDIENTE}
                                      ? ' bg-warning text-dark'
                                      : ' bg-danger'">
                            </span>
                        </td>

                        <td class="text-end">
                            <a th:href="@{/rrhh/vacaciones/solicitudes/ver/{id}(id=${s.id})}"
                               class="btn btn-sm btn-outline-primary">
                                Ver
                            </a>
                        </td>
                    </tr>

                    <tr th:if="${#lists.isEmpty(solicitudes)}">
                        <td colspan="5"
                            class="text-center text-muted py-4">
                            No existen solicitudes asociadas a este periodo
                        </td>
                    </tr>

                    </tbody>
                </table>

            </div>
        </div>

        <!-- ACCIONES -->
        <div class="mt-3 d-flex justify-content-between">

            <a th:href="@{/rrhh/vacaciones/periodos/{id}(id=${periodo.id})}"
               class="btn btn-secondary">
                Volver al periodo
            </a>

            <a th:if="${periodo.estado == T(com.laboratoriosdrogavet.core.rrhh.enums.EstadoPeriodo).ACTIVO}"
               th:href="@{/rrhh/vacaciones/solicitudes/nueva/{id}(id=${periodo.id})}"
               class="btn btn-primary">
                Nueva solicitud
            </a>

        </div>

    </div>

</div>
</body>
</html>
